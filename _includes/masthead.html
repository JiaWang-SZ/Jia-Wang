<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      {% assign is_zh = false %}
      {% if page.lang == "zh" %}
        {% assign is_zh = true %}
      {% endif %}

      {% if is_zh %}
        {% assign switch_url = "/" | relative_url %}
        {% assign switch_label = "English" %}
        {% assign switch_icon = "/images/en.svg" | relative_url %}
      {% else %}
        {% assign switch_url = "/zh/" | relative_url %}
        {% assign switch_label = "中文" %}
        {% assign switch_icon = "/images/cn.svg" | relative_url %}
      {% endif %}

      {% assign nav_items = site.data.navigation.main %}
      {% if is_zh and site.data.navigation.main_zh %}
        {% assign nav_items = site.data.navigation.main_zh %}
      {% endif %}

      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg masthead__menu-home-item">
            <a href="{{ switch_url }}" target="_self">
              <img class="svg" src="{{ switch_icon }}" width="20pt">
              {{ switch_label }}
            </a>
          </li>
          {% for link in nav_items %}
            {% assign nav_url = link.url %}
            {% if is_zh and nav_url contains "/#" %}
              {% assign nav_url = nav_url | replace_first: "/#", "/zh/#" %}
            {% endif %}
            <li class="masthead__menu-item"><a href="{{ nav_url | relative_url }}">{{ link.title }}</a></li>
          {% endfor %}
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
